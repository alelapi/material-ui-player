"use strict";(self.webpackChunkmaterial_ui_player=self.webpackChunkmaterial_ui_player||[]).push([[320],{"./src/stories/public/SoundButton.stories.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,FirebaseStorage:()=>FirebaseStorage,__namedExportsOrder:()=>__namedExportsOrder,default:()=>SoundButton_stories});var react=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),utils=__webpack_require__("./src/lib/utils.ts"),SvgIcon=__webpack_require__("./node_modules/.pnpm/@mui+material@7.0.2_@emotion+react@11.14.0_@types+react@18.2.79_react@18.2.0__@emotion+_e3f05a80d6bbb00477ef0ee9340ba1c0/node_modules/@mui/material/esm/SvgIcon/SvgIcon.js"),IconButton=__webpack_require__("./node_modules/.pnpm/@mui+material@7.0.2_@emotion+react@11.14.0_@types+react@18.2.79_react@18.2.0__@emotion+_e3f05a80d6bbb00477ef0ee9340ba1c0/node_modules/@mui/material/esm/IconButton/IconButton.js"),hooks=__webpack_require__("./src/hooks/index.ts"),jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");const SoundButton=props=>{const{color="primary"}=props,player=(0,react.useRef)(null),{state,pause,load}=(0,hooks.Q)((props=>({url:"",key:Math.random(),playing:!1,time:{currentTime:0,duration:0},playerTimeout:null,src:props.src}))(props)),{onEnded=()=>{}}=props;(0,react.useEffect)(()=>{player.current.onended=()=>{pause(player.current),onEnded()}},[pause,onEnded]);const onPlay=(0,react.useCallback)(async()=>{if(!player.current.src){const audioUrl=await(0,utils.ID)(props.src);load(player.current,audioUrl)}player.current.pause(),player.current.currentTime=0,player.current.play()},[props.src,load]);return(0,jsx_runtime.jsxs)(IconButton.A,{onClick:onPlay,color,"aria-label":"Play",...props.PlayProps?.attributes,size:"large",children:[(0,jsx_runtime.jsx)("audio",{ref:player,style:{display:"none"},children:state.url&&(0,jsx_runtime.jsx)("source",{type:(0,utils.hH)(state.url),src:state.url})},state.key),props.PlayProps?.icons?.[0]||(0,jsx_runtime.jsx)(SvgIcon.A,{viewBox:"0 0 24 24",children:(0,jsx_runtime.jsx)("g",{"data-name":"Layer 2",children:(0,jsx_runtime.jsxs)("g",{"data-name":"volume-up",children:[(0,jsx_runtime.jsx)("rect",{width:"24",height:"24",opacity:"0"}),(0,jsx_runtime.jsx)("path",{d:"M18.28 8.37a1 1 0 1 0-1.56 1.26 4 4 0 0 1 0 4.74A1 1 0 0 0 17.5 16a1 1 0 0 0 .78-.37 6 6 0 0 0 0-7.26z"}),(0,jsx_runtime.jsx)("path",{d:"M19.64 5.23a1 1 0 1 0-1.28 1.54A6.8 6.8 0 0 1 21 12a6.8 6.8 0 0 1-2.64 5.23 1 1 0 0 0-.13 1.41A1 1 0 0 0 19 19a1 1 0 0 0 .64-.23A8.75 8.75 0 0 0 23 12a8.75 8.75 0 0 0-3.36-6.77z"}),(0,jsx_runtime.jsx)("path",{d:"M14.47 3.12a1 1 0 0 0-1 0L7 7.57H2a1 1 0 0 0-1 1v6.86a1 1 0 0 0 1 1h5l6.41 4.4A1.06 1.06 0 0 0 14 21a1 1 0 0 0 1-1V4a1 1 0 0 0-.53-.88z"})]})})})]})};SoundButton.displayName="SoundButton";const components_SoundButton=SoundButton,SoundButton_stories={title:"Components/SoundButton",component:components_SoundButton,argTypes:{color:{defaultValue:"primary",control:{type:"radio"},options:["primary","secondary"]},onEnded:{action:"end"}}},Template=args=>(0,jsx_runtime.jsx)(components_SoundButton,{...args});Template.displayName="Template";const Default=Template.bind({});Default.args={src:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"};const FirebaseStorage=Template.bind({});FirebaseStorage.args={src:new Promise(resolve=>{setTimeout(()=>{resolve("https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3")},500)}),color:"secondary"},Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => <SoundButton {...args} />",...Default.parameters?.docs?.source}}},FirebaseStorage.parameters={...FirebaseStorage.parameters,docs:{...FirebaseStorage.parameters?.docs,source:{originalSource:"args => <SoundButton {...args} />",...FirebaseStorage.parameters?.docs?.source}}};const __namedExportsOrder=["Default","FirebaseStorage"]},"./src/hooks/index.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Q:()=>hooks_useMedia});var react=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js");let ActionType=function(ActionType){return ActionType.PAUSE="PAUSE",ActionType.UPDATE_TIME="UPDATE_TIME",ActionType.UPDATE_URL="UPDATE_URL",ActionType.PLAY="PLAY",ActionType.UPDATE_KEY="UPDATE_KEY",ActionType.UPDATE_SIZE="UPDATE_SIZE",ActionType.RELOAD="RELOAD",ActionType}({});const state_reducer=(state,action)=>{switch(action.type){case ActionType.PAUSE:return{...state,playing:!1};case ActionType.UPDATE_TIME:return{...state,time:action.payload.time,fade:action.payload.fade||0};case ActionType.UPDATE_URL:return{...state,url:action.payload};case ActionType.PLAY:return{...state,playing:!0,playerTimeout:action.payload};case ActionType.UPDATE_KEY:return{...state,key:action.payload.key,src:action.payload.src};case ActionType.UPDATE_SIZE:return{...state,width:action.payload.width,height:action.payload.height};case ActionType.RELOAD:return{...action.payload};default:return state}};var utils=__webpack_require__("./src/lib/utils.ts");const hooks_useMedia=(initialState,fadeSettings)=>{const[state,dispatch]=(0,react.useReducer)(state_reducer,initialState),pause=(0,react.useCallback)(el=>{el.pause(),state.playerTimeout&&clearInterval(state.playerTimeout),dispatch({type:ActionType.PAUSE})},[state.playerTimeout]),setCurrentTime=(0,react.useCallback)((el,value)=>{const currentFade=fadeSettings?(0,utils.HV)(fadeSettings,el.duration,el.currentTime):1,currentTime=void 0===value?el.currentTime:value/100*(el.duration||0);void 0!==value&&(el.currentTime=currentTime);const progressTime={currentTime,duration:el.duration};dispatch({type:ActionType.UPDATE_TIME,payload:{time:progressTime,fade:currentFade}})},[fadeSettings]),load=(0,react.useCallback)((el,url)=>{dispatch({type:ActionType.UPDATE_URL,payload:url}),el.src=url,el.load()},[]),play=(0,react.useCallback)(async el=>{dispatch({type:ActionType.PLAY,payload:setInterval(()=>{setCurrentTime(el)},50)}),await el.play()},[setCurrentTime]),stop=(0,react.useCallback)(el=>{pause(el),setCurrentTime(el,0)},[pause,setCurrentTime]),setProgress=(0,react.useCallback)(async(el,value)=>{if(!el.src){const audioUrl=await(0,utils.ID)(state.src);return load(el,audioUrl),void(el.onloadedmetadata=()=>setCurrentTime(el,value))}setCurrentTime(el,value)},[setCurrentTime,load,state.src]),setSize=(0,react.useCallback)(el=>{const width=state.width||el.videoWidth,height=state.width?el.videoHeight*width/el.videoWidth:el.videoHeight;dispatch({type:ActionType.UPDATE_SIZE,payload:{width,height}})},[state.width,dispatch]),updateSrc=(0,react.useCallback)(src=>{dispatch({type:ActionType.UPDATE_KEY,payload:{key:Math.random(),src}})},[]);return(0,react.useEffect)(()=>{dispatch({type:ActionType.RELOAD,payload:initialState})},[initialState.src]),(0,react.useEffect)(()=>{updateSrc(state.src)},[state.src,updateSrc]),(0,react.useEffect)(()=>()=>{state.playerTimeout&&clearInterval(state.playerTimeout)},[state.playerTimeout]),{state,pause,stop,setCurrentTime,load,play,setProgress,setSize}}},"./src/lib/utils.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{HV:()=>getFade,ID:()=>getUrl,JM:()=>timeToPercentage,cL:()=>thumbThick,hH:()=>getMimeType,kt:()=>getSliderSizes,ot:()=>timeToString});const getTime=n=>{const seconds=Number.isFinite(n)?Math.trunc(n):0,dateString=new Date(1e3*seconds).toISOString();return seconds>=3600?dateString.substr(11,8):dateString.substr(14,5)},timeToPercentage=time=>time?time.currentTime/time.duration*100:0,timeToString=time=>`${getTime(time.currentTime)}/${getTime(time.duration)}`,getMimeType=url=>({mid:"audio/midi",midi:"audio/midi",kar:"audio/midi",mp3:"audio/mpeg",ogg:"audio/ogg",ra:"audio/x-realaudio","3gpp":"video/3gpp","3gp":"video/3gpp",mpeg:"video/mpeg",mpg:"video/mpeg",mov:"video/quicktime",flv:"video/x-flv",mng:"video/x-mng",asx:"video/x-ms-asf",asf:"video/x-ms-asf",wmv:"video/x-ms-wmv",avi:"video/x-msvideo",m4v:"video/mp4",mp4:"video/mp4"}[url.split(/[#?]/)[0].split(".").pop().trim()]),getFade=(settings,duration,currentTime)=>{if(!settings)return 1;const fadeOut=duration-currentTime;return fadeOut<=settings.fadeOutTime?fadeOut/settings.fadeOutTime:currentTime<=settings.fadeInTime?currentTime/settings.fadeInTime:1},getUrl=async src=>"function"==typeof src?await src():await src,lineThick={thin:5,medium:10,large:15},lineMargin={thin:-1,medium:-4,large:-6},thumbThick={thin:15,medium:20,large:25},getSliderSizes=(thickness,others)=>({"& .MuiSlider-thumb":{width:thumbThick[thickness||"thin"],height:thumbThick[thickness||"thin"],marginTop:lineMargin[thickness||"thin"],...others.thumb},"& .MuiSlider-rail":{height:lineThick[thickness||"thin"],marginTop:lineMargin[thickness||"thin"],borderRadius:lineThick[thickness||"thin"],opacity:.38,...others.rail},"& .MuiSlider-track":{height:lineThick[thickness||"thin"],marginTop:lineMargin[thickness||"thin"],borderRadius:lineThick[thickness||"thin"],...others.track}})}}]);